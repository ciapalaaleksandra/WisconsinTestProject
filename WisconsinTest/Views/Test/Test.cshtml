
@{
    var endTime = DateTime.UtcNow.AddSeconds(10);
    var remainingTime = TimeSpan.FromTicks(endTime.Ticks - DateTime.UtcNow.Ticks).TotalSeconds;
}
@{
    //Layout = "~/Views/Shared/_WSCTLayout.cshtml";
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link href="@Url.Content("~/Content/bootstrap.css")" rel="stylesheet" type="text/css" />
    <title>Test</title>
   
</head>


<body class="text-center">

    @using (Html.BeginForm("Test", "Test", FormMethod.Post))
    {
        <div class="py-5">
            <div class="container">
                <div class="row py-2">
                    <div class="col-md-12 text-left">
                        Pozostały czas:
                        <span id="minRemaining"></span>:
                        <span id="secRemaining"></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 col-sm-6 col-lg-3 col-xl-3 col-6">
                        <a href="@Url.Action("Test",new {button="btnCircle"})">
                            <img src="~/Content/Images/circleTest.png" style="width: 250px; height: 250px;" />
                        </a>
                    </div>
                    <div class="col-md-3 col-6 col-sm-6 col-lg-3 col-xl-3">
                        <a href="@Url.Action("Test",new {button="btnStar"})">
                            <img src="~/Content/Images/starTest.png" style="width: 250px; height: 250px;" />
                        </a>
                    </div>
                    <div class="col-md-3 col-6 col-sm-6 col-lg-3 col-xl-3">
                        <a href="@Url.Action("Test",new {button="btnRectangle"})">
                            <img src="~/Content/Images/rectangleTest.png" style="width: 250px; height: 250px;" />
                        </a>
                    </div>
                    <div class="col-md-3 col-sm-6 col-6 col-lg-3 col-xl-3">
                        <a href="@Url.Action("Test",new {button="btnCross"})">
                            <img src="~/Content/Images/crossTest.png" style="width: 250px; height: 250px;" />
                        </a>
                    </div>
                </div>
            </div>
        </div>

    }

    @if (@ViewBag.LastChoiceResult == "Dobrze!")
    {
        <h3 class="text-success">@ViewBag.LastChoiceResult</h3>
    }
    else
    { <h3 class="text-danger">@ViewBag.LastChoiceResult</h3>}

    <h2 style="text-align: center;">
        <img src="@Url.Content(ViewBag.ImagePath)" width="250" height="250" />
    </h2>

    <div class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-md-12 text-left">
                    <button type="button" class="btn btn-danger" onclick="@("window.location.href='" + @Url.Action("Details", "Psychologist", new { id = Session["PatientId"] })  + "'");">
                        Zakończ test
                    </button>
                </div>
            </div>
        </div>
    </div>




    <script>
        var remSeconds = @remainingTime;
        var secondsCounter = remSeconds % 60;
        function formatNumber(number)
        {
            if(number<10) return '0'+ number;
            else return '' + number;
        }

        function startTick()
        {
            document.getElementById('secRemaining').innerText = formatNumber(secondsCounter);
            document.getElementById('minRemaining').innerText = formatNumber(parseInt(remSeconds/60));

            var _tick = setInterval(function()
            {
                    remSeconds = remSeconds-1;
                    secondsCounter = secondsCounter-1;
                    document.getElementById('secRemaining').innerText = formatNumber(secondsCounter);
                    document.getElementById('minRemaining').innerText = formatNumber(parseInt(remSeconds/60));

                    if(secondsCounter==0)
                    {
                        secondsCounter = 60;
                        window.location.href = '@Url.Action("Test", new {button=""})';
                    }
            }, 1000);

        }
        startTick();
    </script>
</body>

</html>
